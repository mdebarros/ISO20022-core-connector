openapi: 3.0.1
info:
  title: ISO 20022 Core Connector
  description: ISO 20022 Core Connector for Mojaloop
  version: 0.0.1
  license:
    name: Apache-2.0

paths:
  /health:
    get:
      summary: Health check endpoint
      description: This endpoint checks the health of the service.
      tags:
        - Health
      responses:
        200:
          description: Returns a success response code if the service is healthy.
  
  /inbound/parties/:idType/:idValue:
    get:
      summary: GET parties
      description: GET parties
      tags:
        - PartiesByTypeAndID
      responses:
        200:
          description: OK
        404:
          description: Not Found - The resource specified in the URI was not found.
          content:
            application/json:
              schema:
                title: NotFoundError
                type: object
                properties:
                  statusCode: 
                    description: Mojaloop error code
                required:
                  - statusCode

  /inbound/quoterequests:
    post:
      summary: Quotes request
      description: Quotes request
      tags:
        - postQuotes
      requestBody:
        content:
          application/json:
            schema:
              title: QuotesPostRequest
              type: object
              properties:
                from:
                  title: Payer party
                  description: Information about the Payer
                  type: object
                  properties:
                    idType:
                      description: Payer's identity type
                    idValue:
                      description: Payer's identifier
                    idSubValue:
                      description: Payer's sub-id
                    fspId:
                      description: Payer's FSP ID
                    extensionList:
                      description: Extension list
                    displayName:
                      description: Payer's display name
                    dateOfBirth:
                      description: Payer's birth date
                    firstName:
                      description: Payer's first name
                    middleName:
                      description: Payer's middle name
                    lastName:
                      description: Payer's last name
                to:
                  title: Payee party
                  description: Information about the Payee
                  type: object
                  properties:
                    idType:
                      description: Payee's identity type
                    idValue:
                      description: Payee's identifier
                    idSubValue:
                      description: Payee's sub-id
                    fspId:
                      description: Payee's FSP ID
                    extensionList:
                      description: Extension list
                    displayName:
                      description: Payee's display name
                    dateOfBirth:
                      description: Payee's birth date
                    firstName:
                      description: Payee's first name
                    middleName:
                      description: Payee's middle name
                    lastName:
                      description: Payee's last name
                quoteId:
                  description: Quote ID
                transactionId: 
                  description: Common ID (decided by the Payer FSP) between the FSPs for the future transaction object.
                amountType:
                  description: Amount type - SEND or RECEIVE
                amount:
                  description: Quote amount.
                currency:
                  description: Quote currency.
                transactionType:
                  description: Transaction scenario
                initiator:
                  description: Initiator
                initiatorType:
                  description: Initiator type
                feeAmount:
                  description: Fee amount
                feeCurrency:
                  description: Fee currency
                geoCode:
                  description: Geo code
                note:
                  description: Note
                expiration:
                  description: Quote expiration
        required: true
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                title: Quote response
                type: object
                properties:
                  quoteId:
                    description: Quote ID
                  transactionId:
                    description: Transaction ID
                  transferAmount:
                    description: Transfer amount
                  payeeReceiveAmount:
                    description: Payee receive amount
                  transferAmountCurrency:
                    description: Transfer amount currency
                  payeeReceiveAmountCurrency:
                    description: Payee receive amount currency
                  expiration:
                    description: Transfer expiration
        500:
          description: Quote error
          content:
            application/json:
              schema:
                title: Quote error
                type: object
                properties:
                  statusCode: 
                    description: Mojaloop error code
                required:
                  - statusCode 
  
  /inbound/transfers:
    post:
      summary: Transfer request
      description: Transfer request
      tags:
        - postTransfer
      requestBody:
        content:
          application/json:
            schema:
              title: TransfersPostRequest
              type: object
              oneOf:
                - properties:
                    transferId:
                      description: Transfer ID
                    quote:
                      description: Quote response
                      type: object
                      properties:
                        quoteId:
                          description: Quote ID
                        transactionId:
                          description: Transaction ID
                        transferAmount:
                          description: Transfer amount
                        payeeReceiveAmount:
                          description: Payee receive amount
                        payeeReceiveAmountCurrency:
                          description: Payee receive amount currency
                        expiration:
                          description: Quote expiration
                    from:
                      title: Payer party
                      description: Information about the Payer
                      type: object
                      properties:
                        idType:
                          description: Payer's identity type
                        idValue:
                          description: Payer's identifier
                        idSubValue:
                          description: Payer's sub-id
                        fspId:
                          description: Payer's FSP ID
                        extensionList:
                          description: Extension list
                        displayName:
                          description: Payer's display name
                        dateOfBirth:
                          description: Payer's birth date
                        firstName:
                          description: Payer's first name
                        middleName:
                          description: Payer's middle name
                        lastName:
                          description: Payer's last name
                    to:
                      title: Payee party
                      description: Information about the Payee
                      type: object
                      properties:
                        idType:
                          description: Payee's identity type
                        idValue:
                          description: Payee's identifier
                        idSubValue:
                          description: Payee's sub-id
                        fspId:
                          description: Payee's FSP ID
                        extensionList:
                          description: Extension list
                        displayName:
                          description: Payee's display name
                        dateOfBirth:
                          description: Payee's birth date
                        firstName:
                          description: Payee's first name
                        middleName:
                          description: Payee's middle name
                        lastName:
                          description: Payee's last name
                    amount:
                      description: Amount
                    amountType:
                      description: Amount type
                    currency:
                      description: Currency
                    transactionType:
                      description: Transactioon type
                    note:
                      description: Note
                - properties:
                    transferId:
                      description: Transfer ID
                    currency:
                      description: Currency
                    amount:
                      description: Amount
        required: true
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                title: Transfer response
                type: object
                properties:
                  homeTransactionId:
                    description: Backend transaction identifier
        500:
          description: Tranfer error
          content:
            application/json:
              schema:
                title: Tranfer error
                type: object
                properties:
                  statusCode: 
                    description: Mojaloop error code
                required:
                  - statusCode 

  /outbound/iso20022:
    post:
      summary: POST ISO 20022 message
      description: POST ISO 20022 message
      tags:
        - postISO20022
      requestBody:
        content:
          application/xml:
            schema:
              oneOf:
                - $ref: '#/components/schemas/PAIN.001'
                # - $ref: '#/components/schemas/PAIN.002'
                # - $ref: '#/components/schemas/PAIN.008'
                # - $ref: '#/components/schemas/PAIN.013'
        required: true
      responses:
        200:
          description: OK


components:
  schemas:
    PAIN.001:
      type: object
      description: ISO 20022 PAIN.001 message
      properties:
        Document:
          type: object
          properties:
            CstmrCdtTrfInitn:
              type: array
              maxItems: 1
              items:
                type: object
                properties:
                  GrpHdr:
                    type: array
                    items:
                      type: object
                      properties:
                        MsgId:
                          type: array
                          maxItems: 1
                          items:
                            $ref: '#/components/schemas/UUID'
                        CreDtTm:
                          type: array
                          maxItems: 1
                          items:
                            type: string
                            format: date-time
                        NbOfTxs:
                          type: array
                          maxItems: 1
                          items:
                            type: string
                        InitgPty:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              Nm:
                                type: array
                                maxItems: 1
                                items:
                                  type: string
                              Id:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:  
                                    OrgId:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: object
                                        properties:
                                          AnyBIC:
                                            type: array
                                            maxItems: 1
                                            items:
                                              type: string
                  PmtInf:
                    type: array
                    maxItems: 1
                    items:
                      type: object
                      properties:
                        PmtInfId:
                          type: array
                          maxItems: 1
                          items:
                            $ref: '#/components/schemas/UUID'
                        PmtMtd:
                          type: array
                          maxItems: 1
                          items:
                            type: string
                        ReqdExctnDt:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              Dt:
                                type: array
                                maxItems: 1
                                items:
                                  type: string
                                  format: date
                        Dbtr:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              CtctDtls:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    MobNb:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: string
                        DbtrAcct:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              Id:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    Othr:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: object
                                        properties:
                                          Id:
                                            type: array
                                            maxItems: 1
                                            items:
                                              type: string
                        DbtrAgt:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              FinInstnId:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    BICFI:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: string
                                    Nm:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: string
                        ChrgBr:
                          type: array
                          maxItems: 1
                          items:
                            type: string
                        CdtTrfTxInf:
                          type: array
                          maxItems: 1
                          items:
                            type: object
                            properties:
                              PmtId:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    EndToEndId:
                                      type: array
                                      maxItems: 1
                                      items:
                                        $ref: '#/components/schemas/UUID'
                              Amt:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    InstdAmt:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: object
                                        properties:
                                          _:
                                            type: string
                                          $:
                                            type: object
                                            properties:
                                              Ccy:
                                                type: string 
                              CdtrAgt:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:
                                    FinInstnId:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: object
                                        properties:
                                          BICFI:
                                            type: array
                                            maxItems: 1
                                            items:
                                              type: string

                              Cdtr:
                                type: array
                                maxItems: 1
                                items:
                                  type: object
                                  properties:  
                                    CtctDtls:
                                      type: array
                                      maxItems: 1
                                      items:
                                        type: object
                                        properties:
                                          MobNb:
                                            type: array
                                            maxItems: 1
                                            items:
                                              type: string
            $:
              type: object
              properties:
                xmlns:
                  type: string
                  pattern: 'urn:iso:std:iso:20022:tech:xsd:pain.001.001.10'
                xmlns:xsi:
                  type: string
                  pattern: 'http://www.w3.org/2001/XMLSchema-instance'
              required:
                - xmlns

          required:
            - CstmrCdtTrfInitn
            - $
      required: 
        - Document
  
    UUID:
      title: ID
      type: string
      pattern: >-
        ^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$